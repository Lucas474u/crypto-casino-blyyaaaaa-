<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TON Casino - Real-time Crypto Casino</title>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        :root {
            --primary: #0088cc;
            --primary-dark: #006699;
            --secondary: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --dark: #1a1a2e;
            --dark-light: #2d3047;
            --light: #ecf0f1;
            --gray: #95a5a6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .logo {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(45deg, #0088cc, #00aaff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* –ë–ª–æ–∫ –∫–æ—à–µ–ª—å–∫–∞ */
        .wallet-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .balance {
            background: var(--dark-light);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
        }

        #connect-wallet {
            background: linear-gradient(45deg, #0088cc, #00aaff);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s;
        }

        #connect-wallet:hover {
            transform: translateY(-2px);
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∏–≥—Ä–∞–º */
        .games-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            background: var(--dark-light);
            padding: 10px;
            border-radius: 15px;
        }

        .game-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .game-tab.active {
            background: var(--primary);
        }

        /* –ò–≥—Ä–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å */
        .game-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .game-container {
                grid-template-columns: 1fr;
            }
        }

        /* –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ */
        .game-board {
            background: var(--dark-light);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        /* –ì—Ä–∞—Ñ–∏–∫ –∫—Ä–∞—à–∞ */
        .crash-chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 20px;
        }

        .crash-multiplier {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 48px;
            font-weight: 700;
            background: linear-gradient(45deg, #2ecc71, #f1c40f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            z-index: 10;
        }

        /* –ö–Ω–æ–ø–∫–∞ —Å—Ç–∞–≤–∫–∏ */
        .bet-button {
            width: 100%;
            padding: 20px;
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .bet-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(46, 204, 113, 0.3);
        }

        .bet-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* –ë–ª–æ–∫ —Å—Ç–∞–≤–æ–∫ */
        .bet-controls {
            background: var(--dark-light);
            border-radius: 20px;
            padding: 25px;
        }

        .bet-input-group {
            margin-bottom: 20px;
        }

        .bet-input-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--gray);
        }

        .bet-input {
            width: 100%;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            color: white;
            font-size: 16px;
        }

        /* –ü–æ–ª–∑—É–Ω–∫–∏ */
        .slider-container {
            margin: 20px 0;
        }

        .slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }

        /* –ü–æ–ª–µ –º–∏–Ω */
        .mines-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .mine-cell {
            aspect-ratio: 1;
            background: var(--dark);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            user-select: none;
        }

        .mine-cell:hover:not(.revealed) {
            background: var(--primary);
            transform: scale(1.05);
        }

        .mine-cell.revealed.mine {
            background: var(--danger);
        }

        .mine-cell.revealed.safe {
            background: var(--secondary);
        }

        /* –ò–≥—Ä–∞–ª—å–Ω—ã–µ –∫–æ—Å—Ç–∏ */
        .dice-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }

        .dice {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: bold;
            color: var(--dark);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫ */
        .bets-history {
            background: var(--dark-light);
            border-radius: 20px;
            padding: 25px;
            margin-top: 20px;
        }

        .bets-history h3 {
            margin-bottom: 15px;
        }

        .bets-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .bet-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes crashRising {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes diceRoll {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .crash-rising {
            animation: crashRising 0.5s ease-in-out;
        }

        .dice-rolling {
            animation: diceRoll 0.5s linear;
        }

        /* –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π */
        .users-online {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.1);
            padding: 8px 12px;
            border-radius: 20px;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            .mines-grid {
                grid-template-columns: repeat(5, 1fr);
            }
            
            .dice {
                width: 60px;
                height: 60px;
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –®–∞–ø–∫–∞ -->
        <header class="header">
            <div class="logo">TON CASINO</div>
            <div class="wallet-section">
                <div class="balance">
                    –ë–∞–ª–∞–Ω—Å: <span id="wallet-balance">0</span> TON
                </div>
                <button id="connect-wallet">Connect Wallet</button>
            </div>
        </header>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∏–≥—Ä–∞–º -->
        <nav class="games-nav">
            <button class="game-tab active" data-game="crash">CRASH</button>
            <button class="game-tab" data-game="mines">MINES</button>
            <button class="game-tab" data-game="dice">DICE</button>
        </nav>

        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–≥—Ä–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å -->
        <div class="game-container">
            <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
            <div class="game-board">
                <!-- Crash –∏–≥—Ä–∞ -->
                <div id="crash-game" class="game-content active">
                    <div class="crash-chart-container">
                        <div class="crash-multiplier" id="crash-multiplier">1.00x</div>
                        <canvas id="crash-chart"></canvas>
                    </div>
                    <div class="game-info">
                        <div>–°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥ —á–µ—Ä–µ–∑: <span id="next-round-timer">5</span>—Å</div>
                        <div>–ò–≥—Ä–æ–∫–æ–≤ –≤ —Ä–∞—É–Ω–¥–µ: <span id="players-count">0</span></div>
                    </div>
                </div>

                <!-- Mines –∏–≥—Ä–∞ -->
                <div id="mines-game" class="game-content" style="display: none;">
                    <div class="mines-controls">
                        <div class="slider-container">
                            <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω: <span id="mines-count">5</span></label>
                            <input type="range" min="1" max="24" value="5" class="slider" id="mines-slider">
                        </div>
                        <div class="mines-grid" id="mines-grid">
                            <!-- 25 –∫–ª–µ—Ç–æ–∫ –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                        </div>
                        <div class="mines-info">
                            <div>–ù–∞–π–¥–µ–Ω–æ: <span id="found-safe">0</span>/<span id="total-safe">20</span></div>
                            <div>–ú–Ω–æ–∂–∏—Ç–µ–ª—å: <span id="mines-multiplier">1.00x</span></div>
                        </div>
                    </div>
                </div>

                <!-- Dice –∏–≥—Ä–∞ -->
                <div id="dice-game" class="game-content" style="display: none;">
                    <div class="dice-container">
                        <div class="dice" id="dice-1">‚öÑ</div>
                        <div class="dice" id="dice-2">‚öÑ</div>
                    </div>
                    <div class="dice-controls">
                        <div class="slider-container">
                            <label>–¶–µ–ª–µ–≤–æ–µ —á–∏—Å–ª–æ: <span id="target-number">7</span></label>
                            <input type="range" min="2" max="12" value="7" class="slider" id="dice-slider">
                        </div>
                        <div class="dice-info">
                            <div>–®–∞–Ω—Å –≤—ã–∏–≥—Ä—ã—à–∞: <span id="win-chance">58%</span></div>
                            <div>–ú–Ω–æ–∂–∏—Ç–µ–ª—å: <span id="dice-multiplier">1.72x</span></div>
                        </div>
                    </div>
                </div>

                <button class="bet-button" id="place-bet">–°–î–ï–õ–ê–¢–¨ –°–¢–ê–í–ö–£</button>
                <button class="bet-button" id="cash-out" style="display: none; background: linear-gradient(45deg, #e74c3c, #c0392b);">–í–´–í–ï–°–¢–ò</button>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å —Å—Ç–∞–≤–æ–∫ -->
            <div class="bet-controls">
                <div class="bet-input-group">
                    <label>–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏ (TON)</label>
                    <input type="number" class="bet-input" id="bet-amount" value="0.01" step="0.01" min="0.01">
                </div>

                <div class="bet-input-group">
                    <label>–ê–≤—Ç–æ–≤—ã–≤–æ–¥</label>
                    <input type="number" class="bet-input" id="auto-cashout" value="2.00" step="0.1" min="1.1" placeholder="–ú–Ω–æ–∂–∏—Ç–µ–ª—å">
                </div>

                <!-- –ë—ã—Å—Ç—Ä—ã–µ —Å—Ç–∞–≤–∫–∏ -->
                <div class="quick-bets">
                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <button class="quick-bet" data-amount="0.01">0.01</button>
                        <button class="quick-bet" data-amount="0.1">0.1</button>
                        <button class="quick-bet" data-amount="0.5">0.5</button>
                        <button class="quick-bet" data-amount="1">1</button>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="quick-bet" data-amount="2">2</button>
                        <button class="quick-bet" data-amount="5">5</button>
                        <button class="quick-bet" data-amount="10">10</button>
                        <button class="quick-bet" data-amount="50">50</button>
                    </div>
                </div>

                <!-- –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫ -->
                <div class="bets-history">
                    <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç–∞–≤–∫–∏</h3>
                    <div class="bets-list" id="recent-bets">
                        <!-- –°—Ç–∞–≤–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>

                <!-- –û–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ -->
                <div class="users-online" id="online-users">
                    <!-- –ü—Ä–æ—Ñ–∏–ª–∏ –∏–∑ Telegram -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TON Connect
        const manifest = {
            name: "TON Casino",
            description: "Real-time crypto casino with Crash, Mines, Dice games",
            url: window.location.origin,
            iconUrl: `${window.location.origin}/icon.png`,
            bridgeUrl: "https://bridge.tonapi.io/bridge"
        };

        const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
            manifest: manifest
        });

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const state = {
            wallet: null,
            balance: 0,
            activeGame: 'crash',
            currentBet: 0,
            isPlaying: false,
            crashMultiplier: 1.00,
            crashChart: null,
            minesCount: 5,
            diceTarget: 7,
            recentBets: []
        };

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const elements = {
            connectWalletBtn: document.getElementById('connect-wallet'),
            walletBalance: document.getElementById('wallet-balance'),
            betAmount: document.getElementById('bet-amount'),
            placeBetBtn: document.getElementById('place-bet'),
            cashOutBtn: document.getElementById('cash-out'),
            crashMultiplier: document.getElementById('crash-multiplier'),
            crashChart: document.getElementById('crash-chart'),
            gameTabs: document.querySelectorAll('.game-tab'),
            gameContents: {
                crash: document.getElementById('crash-game'),
                mines: document.getElementById('mines-game'),
                dice: document.getElementById('dice-game')
            },
            minesGrid: document.getElementById('mines-grid'),
            minesSlider: document.getElementById('mines-slider'),
            minesCount: document.getElementById('mines-count'),
            diceSlider: document.getElementById('dice-slider'),
            targetNumber: document.getElementById('target-number'),
            recentBetsList: document.getElementById('recent-bets'),
            onlineUsers: document.getElementById('online-users')
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        async function init() {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ –∫–æ—à–µ–ª—å–∫–∞
            const wallets = await tonConnectUI.getWallets();
            const connectedWallets = await tonConnectUI.getConnectedWallet();
            
            if (connectedWallets) {
                state.wallet = connectedWallets;
                updateWalletInfo();
            }

            // –°–æ–±—ã—Ç–∏—è
            setupEventListeners();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä
            initCrashGame();
            initMinesGame();
            initDiceGame();
            
            // –°–∏–º—É–ª—è—Ü–∏—è –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            simulateOnlineUsers();
            
            // –°–∏–º—É–ª—è—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Å—Ç–∞–≤–æ–∫
            simulateRecentBets();
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
            elements.connectWalletBtn.addEventListener('click', async () => {
                try {
                    const wallet = await tonConnectUI.connectWallet();
                    state.wallet = wallet;
                    updateWalletInfo();
                } catch (error) {
                    console.error('Error connecting wallet:', error);
                }
            });

            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä
            elements.gameTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const game = tab.dataset.game;
                    switchGame(game);
                });
            });

            // –°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É
            elements.placeBetBtn.addEventListener('click', placeBet);

            // –í—ã–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞
            elements.cashOutBtn.addEventListener('click', cashOut);

            // –ë—ã—Å—Ç—Ä—ã–µ —Å—Ç–∞–≤–∫–∏
            document.querySelectorAll('.quick-bet').forEach(btn => {
                btn.addEventListener('click', () => {
                    elements.betAmount.value = btn.dataset.amount;
                });
            });

            // –ü–æ–ª–∑—É–Ω–æ–∫ –º–∏–Ω
            elements.minesSlider.addEventListener('input', (e) => {
                state.minesCount = parseInt(e.target.value);
                elements.minesCount.textContent = state.minesCount;
                updateMinesMultiplier();
                resetMinesGame();
            });

            // –ü–æ–ª–∑—É–Ω–æ–∫ dice
            elements.diceSlider.addEventListener('input', (e) => {
                state.diceTarget = parseInt(e.target.value);
                elements.targetNumber.textContent = state.diceTarget;
                updateDiceMultiplier();
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ—à–µ–ª—å–∫–µ
        async function updateWalletInfo() {
            if (!state.wallet) return;
            
            try {
                // –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
                const response = await fetch(
                    `https://tonapi.io/v2/accounts/${state.wallet.account.address}`
                );
                const data = await response.json();
                const balance = (data.balance / 1000000000).toFixed(2);
                
                state.balance = parseFloat(balance);
                elements.walletBalance.textContent = balance;
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
                elements.connectWalletBtn.textContent = 
                    `${state.wallet.account.address.slice(0, 6)}...${state.wallet.account.address.slice(-4)}`;
            } catch (error) {
                console.error('Error fetching balance:', error);
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –∏–≥—Ä–∞–º–∏
        function switchGame(game) {
            state.activeGame = game;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–∞–±–æ–≤
            elements.gameTabs.forEach(tab => {
                tab.classList.toggle('active', tab.dataset.game === game);
            });
            
            // –ü–æ–∫–∞–∑ –∞–∫—Ç–∏–≤–Ω–æ–π –∏–≥—Ä—ã
            Object.keys(elements.gameContents).forEach(key => {
                elements.gameContents[key].style.display = 
                    key === game ? 'block' : 'none';
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∫–Ω–æ–ø–∫–∏
            if (game === 'crash') {
                elements.placeBetBtn.textContent = '–°–î–ï–õ–ê–¢–¨ –°–¢–ê–í–ö–£';
                elements.cashOutBtn.style.display = state.isPlaying ? 'block' : 'none';
            } else if (game === 'mines') {
                elements.placeBetBtn.textContent = '–ù–ê–ß–ê–¢–¨ –ò–ì–†–£';
                elements.cashOutBtn.textContent = '–ó–ê–ë–†–ê–¢–¨ –í–´–ò–ì–†–´–®';
                elements.cashOutBtn.style.display = 'none';
                resetMinesGame();
            } else if (game === 'dice') {
                elements.placeBetBtn.textContent = '–ë–†–û–°–ò–¢–¨ –ö–û–°–¢–ò';
                elements.cashOutBtn.style.display = 'none';
            }
        }

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´ CRASH
        function initCrashGame() {
            // –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
            const ctx = elements.crashChart.getContext('2d');
            state.crashChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 50}, (_, i) => i),
                    datasets: [{
                        label: '–ú–Ω–æ–∂–∏—Ç–µ–ª—å',
                        data: Array(50).fill(1),
                        borderColor: '#2ecc71',
                        backgroundColor: 'rgba(46, 204, 113, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: { display: false },
                        y: {
                            beginAtZero: false,
                            min: 1,
                            ticks: {
                                color: 'rgba(255,255,255,0.7)',
                                callback: value => value.toFixed(1) + 'x'
                            },
                            grid: { color: 'rgba(255,255,255,0.1)' }
                        }
                    }
                }
            });

            // –°–∏–º—É–ª—è—Ü–∏—è –∏–≥—Ä—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
            simulateCrashGame();
        }

        // –°–∏–º—É–ª—è—Ü–∏—è –∏–≥—Ä—ã Crash
        function simulateCrashGame() {
            let multiplier = 1.00;
            let isRising = false;
            let crashAt = Math.random() * 10 + 1.5;

            setInterval(() => {
                if (isRising && multiplier < crashAt) {
                    multiplier += 0.01;
                    state.crashMultiplier = multiplier;
                    elements.crashMultiplier.textContent = multiplier.toFixed(2) + 'x';
                    elements.crashMultiplier.classList.add('crash-rising');
                    
                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
                    const chart = state.crashChart;
                    chart.data.datasets[0].data.shift();
                    chart.data.datasets[0].data.push(multiplier);
                    chart.update('none');

                    setTimeout(() => {
                        elements.crashMultiplier.classList.remove('crash-rising');
                    }, 500);
                }

                if (multiplier >= crashAt && isRising) {
                    isRising = false;
                    setTimeout(() => {
                        multiplier = 1.00;
                        crashAt = Math.random() * 10 + 1.5;
                        elements.crashMultiplier.textContent = '1.00x';
                        chart.data.datasets[0].data = Array(50).fill(1);
                        chart.update();
                    }, 3000);
                }
            }, 100);

            // –ó–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ —Ä–∞—É–Ω–¥–∞ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
            setInterval(() => {
                if (!isRising) {
                    isRising = true;
                    multiplier = 1.00;
                }
            }, 5000);
        }

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´ MINES
        function initMinesGame() {
            resetMinesGame();
            updateMinesMultiplier();
        }

        function resetMinesGame() {
            elements.minesGrid.innerHTML = '';
            
            // –°–æ–∑–¥–∞–Ω–∏–µ 25 –∫–ª–µ—Ç–æ–∫
            for (let i = 0; i < 25; i++) {
                const cell = document.createElement('div');
                cell.className = 'mine-cell';
                cell.dataset.index = i;
                cell.dataset.type = 'hidden'; // hidden, safe, mine
                
                cell.addEventListener('click', () => revealMineCell(i));
                elements.minesGrid.appendChild(cell);
            }
        }

        function updateMinesMultiplier() {
            const safeCells = 25 - state.minesCount;
            const multiplier = (25 / safeCells).toFixed(2);
            document.getElementById('mines-multiplier').textContent = multiplier + 'x';
        }

        function revealMineCell(index) {
            if (!state.isPlaying || state.activeGame !== 'mines') return;
            
            const cell = elements.minesGrid.children[index];
            
            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –º–∏–Ω–∞ —ç—Ç–æ –∏–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–ª–µ—Ç–∫–∞
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —ç—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º
            const isMine = Math.random() < (state.minesCount / 25);
            
            cell.classList.add('revealed');
            cell.classList.add(isMine ? 'mine' : 'safe');
            cell.textContent = isMine ? 'üí£' : 'üíé';
            
            if (isMine) {
                // –ü—Ä–æ–∏–≥—Ä—ã—à
                alert('–í—ã –Ω–∞—à–ª–∏ –º–∏–Ω—É! –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞.');
                state.isPlaying = false;
                elements.placeBetBtn.disabled = false;
                elements.cashOutBtn.style.display = 'none';
            } else {
                // –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∏–≥—Ä—ã
                const safeCount = document.querySelectorAll('.mine-cell.safe').length;
                document.getElementById('found-safe').textContent = safeCount;
                
                if (safeCount === (25 - state.minesCount)) {
                    // –í—Å–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ –Ω–∞–π–¥–µ–Ω—ã
                    cashOut();
                }
            }
        }

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´ DICE
        function initDiceGame() {
            updateDiceMultiplier();
        }

        function updateDiceMultiplier() {
            const winProbability = Math.max(1, Math.min(11, Math.abs(7 - state.diceTarget) + 1));
            const multiplier = (1 / (winProbability / 36)).toFixed(2);
            
            document.getElementById('win-chance').textContent = 
                Math.round((winProbability / 36) * 100) + '%';
            document.getElementById('dice-multiplier').textContent = multiplier + 'x';
        }

        function rollDice() {
            const dice1 = document.getElementById('dice-1');
            const dice2 = document.getElementById('dice-2');
            
            dice1.classList.add('dice-rolling');
            dice2.classList.add('dice-rolling');
            
            setTimeout(() => {
                const roll1 = Math.floor(Math.random() * 6) + 1;
                const roll2 = Math.floor(Math.random() * 6) + 1;
                const total = roll1 + roll2;
                
                dice1.textContent = getDiceFace(roll1);
                dice2.textContent = getDiceFace(roll2);
                
                dice1.classList.remove('dice-rolling');
                dice2.classList.remove('dice-rolling');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∏–≥—Ä—ã—à–∞
                const isWin = (state.diceTarget >= 7 && total >= state.diceTarget) ||
                             (state.diceTarget < 7 && total <= state.diceTarget);
                
                if (isWin) {
                    const multiplier = parseFloat(document.getElementById('dice-multiplier').textContent);
                    const winAmount = state.currentBet * multiplier;
                    
                    alert(`–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${winAmount.toFixed(2)} TON!`);
                    state.balance += winAmount;
                    updateWalletInfo();
                } else {
                    alert('–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ —Å—Ç–∞–≤–∫—É');
                }
                
                state.isPlaying = false;
                elements.placeBetBtn.disabled = false;
                
            }, 1000);
        }

        function getDiceFace(number) {
            const faces = ['‚öÄ', '‚öÅ', '‚öÇ', '‚öÉ', '‚öÑ', '‚öÖ'];
            return faces[number - 1];
        }

        // –°–î–ï–õ–ê–¢–¨ –°–¢–ê–í–ö–£
        async function placeBet() {
            if (!state.wallet) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫');
                return;
            }
            
            const amount = parseFloat(elements.betAmount.value);
            
            if (isNaN(amount) || amount <= 0) {
                alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É —Å—Ç–∞–≤–∫–∏');
                return;
            }
            
            if (amount > state.balance) {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ');
                return;
            }
            
            state.currentBet = amount;
            state.isPlaying = true;
            elements.placeBetBtn.disabled = true;
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
            console.log(`–°—Ç–∞–≤–∫–∞ ${amount} TON –Ω–∞ –∏–≥—Ä—É ${state.activeGame}`);
            
            if (state.activeGame === 'crash') {
                elements.cashOutBtn.style.display = 'block';
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏ –≤ –∏—Å—Ç–æ—Ä–∏—é
                addRecentBet({
                    user: '–í—ã',
                    amount: amount,
                    game: 'crash',
                    multiplier: '?',
                    time: new Date().toLocaleTimeString()
                });
            } else if (state.activeGame === 'mines') {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –≤ –º–∏–Ω—ã
                elements.cashOutBtn.style.display = 'block';
                elements.cashOutBtn.textContent = '–ó–ê–ë–†–ê–¢–¨ –í–´–ò–ì–†–´–®';
                
                addRecentBet({
                    user: '–í—ã',
                    amount: amount,
                    game: 'mines',
                    multiplier: '?',
                    time: new Date().toLocaleTimeString()
                });
            } else if (state.activeGame === 'dice') {
                rollDice();
                
                addRecentBet({
                    user: '–í—ã',
                    amount: amount,
                    game: 'dice',
                    multiplier: document.getElementById('dice-multiplier').textContent,
                    time: new Date().toLocaleTimeString()
                });
            }
        }

        // –í–´–í–ï–°–¢–ò –°–†–ï–î–°–¢–í–ê
        function cashOut() {
            if (!state.isPlaying) return;
            
            let winAmount = 0;
            
            if (state.activeGame === 'crash') {
                winAmount = state.currentBet * state.crashMultiplier;
                alert(`–í—ã –≤—ã–≤–µ–ª–∏ ${winAmount.toFixed(2)} TON –Ω–∞ –º–Ω–æ–∂–∏—Ç–µ–ª–µ ${state.crashMultiplier.toFixed(2)}x`);
            } else if (state.activeGame === 'mines') {
                const safeCount = document.querySelectorAll('.mine-cell.safe').length;
                const multiplier = parseFloat(document.getElementById('mines-multiplier').textContent);
                winAmount = state.currentBet * multiplier * (safeCount / (25 - state.minesCount));
                alert(`–í—ã –≤—ã–≤–µ–ª–∏ ${winAmount.toFixed(2)} TON`);
            }
            
            state.balance += winAmount;
            state.isPlaying = false;
            
            elements.placeBetBtn.disabled = false;
            elements.cashOutBtn.style.display = 'none';
            
            updateWalletInfo();
            resetMinesGame();
        }

        // –°–∏–º—É–ª—è—Ü–∏—è –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function simulateOnlineUsers() {
            const users = [
                { name: 'Irixss', avatar: 'IR' },
                { name: 'Catanis', avatar: 'CA' },
                { name: 'Tarob', avatar: 'TA' },
                { name: 'Cemyr', avatar: 'CE' },
                { name: 'Vissar', avatar: 'VI' },
                { name: 'Negr', avatar: 'NE' },
                { name: 'Argsvld', avatar: 'AR' }
            ];
            
            users.forEach(user => {
                const profile = document.createElement('div');
                profile.className = 'user-profile';
                profile.innerHTML = `
                    <div class="user-avatar">${user.avatar}</div>
                    <span>${user.name}</span>
                `;
                elements.onlineUsers.appendChild(profile);
            });
        }

        // –°–∏–º—É–ª—è—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Å—Ç–∞–≤–æ–∫
        function simulateRecentBets() {
            const bets = [
                { user: 'Irixss', amount: 2.33, multiplier: 1.29, result: 3.01 },
                { user: 'Tarob', amount: 0.96, multiplier: 1.64, result: 1.57 },
                { user: 'Cemyr', amount: 0.90, multiplier: 1.55, result: 1.39 },
                { user: 'Vissar', amount: 0.50, multiplier: 1.29, result: 0.64 },
                { user: 'Negr', amount: 0.30, multiplier: 1.43, result: 0.43 },
                { user: 'Argsvld', amount: 0.28, multiplier: 1.13, result: 0.31 }
            ];
            
            bets.forEach(bet => addRecentBet({
                ...bet,
                game: 'crash',
                time: '—Ç–æ–ª—å–∫–æ —á—Ç–æ'
            }));
        }

        function addRecentBet(bet) {
            const betItem = document.createElement('div');
            betItem.className = 'bet-item';
            betItem.innerHTML = `
                <div>
                    <strong>${bet.user}</strong>
                    <div style="font-size: 12px; color: #95a5a6;">${bet.game} ‚Ä¢ ${bet.time}</div>
                </div>
                <div style="text-align: right;">
                    ${bet.amount} TON
                    <div style="font-size: 12px; color: #2ecc71;">
                        ${bet.multiplier} ‚Üí ${bet.result || '?'} TON
                    </div>
                </div>
            `;
            
            elements.recentBetsList.prepend(betItem);
            state.recentBets.unshift(bet);
            
            // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
            if (state.recentBets.length > 10) {
                state.recentBets.pop();
                if (elements.recentBetsList.children.length > 10) {
                    elements.recentBetsList.removeChild(elements.recentBetsList.lastChild);
                }
            }
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
